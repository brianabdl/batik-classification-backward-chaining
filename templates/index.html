{% extends "base.html" %}

{% block content %}
<div class="form-container">
    <h2 class="page-title">Klasifikasi Batik Expert System</h2>

    <div class="upload-section">
        <label for="imageInput">Upload Foto Batik (Opsional)</label>
        <label for="imageInput" class="upload-btn">Pilih Gambar</label>
        <input type="file" name="image" id="imageInput" accept="image/*">
        
        <div id="previewContainer" style="display:none;">
            <h4 style="margin: 1rem 0 0.5rem; color: #1e40af;">Preview Gambar</h4>
            <img id="previewImage" alt="Preview batik">
        </div>
    </div>

    <p class="page-subtitle">
        Pilih <strong>Ya</strong> atau <strong>Tidak</strong> untuk setiap kriteria dengan cepat. 
        Sistem akan menganalisis teknik pembuatan dan menentukan kualitas batik Anda secara otomatis.
    </p>
    <form method="post" enctype="multipart/form-data">
        <div class="form-grid">
            <div class="form-section">
                <h3>Teknik & Pola</h3>

                <div class="field">
                    <label for="motif_name">Nama Motif (opsional)</label>
                    <input type="text" id="motif_name" name="motif_name"
                           placeholder="Contoh: Parang, Kawung, Mega Mendung">
                </div>

                <div class="field">
                    <label>Pola berulang sangat teratur?</label>
                    <div class="toggle-group">
                        <input type="radio" id="pattern_repeated_yes" name="pattern_repeated" value="yes">
                        <label for="pattern_repeated_yes" class="toggle-label">Ya</label>
                        
                        <input type="radio" id="pattern_repeated_no" name="pattern_repeated" value="no" checked>
                        <label for="pattern_repeated_no" class="toggle-label">Tidak</label>
                    </div>
                </div>

                <div class="field">
                    <label>Goresan tidak simetris / bervariasi?</label>
                    <div class="toggle-group">
                        <input type="radio" id="strokes_irregular_yes" name="strokes_irregular" value="yes">
                        <label for="strokes_irregular_yes" class="toggle-label">Ya</label>
                        
                        <input type="radio" id="strokes_irregular_no" name="strokes_irregular" value="no" checked>
                        <label for="strokes_irregular_no" class="toggle-label">Tidak</label>
                    </div>
                </div>

                <div class="field">
                    <label>Malam (wax) terlihat jelas?</label>
                    <div class="toggle-group">
                        <input type="radio" id="wax_visible_yes" name="wax_visible" value="yes">
                        <label for="wax_visible_yes" class="toggle-label">Ya</label>
                        
                        <input type="radio" id="wax_visible_no" name="wax_visible" value="no" checked>
                        <label for="wax_visible_no" class="toggle-label">Tidak</label>
                    </div>
                </div>

                <div class="field">
                    <label>Pola seragam seperti cetakan mesin?</label>
                    <div class="toggle-group">
                        <input type="radio" id="machine_like_yes" name="machine_like" value="yes">
                        <label for="machine_like_yes" class="toggle-label">Ya</label>
                        
                        <input type="radio" id="machine_like_no" name="machine_like" value="no" checked>
                        <label for="machine_like_no" class="toggle-label">Tidak</label>
                    </div>
                </div>
            </div>

            <div class="form-section">
                <h3>Kualitas Warna & Kain</h3>

                <div class="field">
                    <label>Warna tajam / cerah?</label>
                    <div class="toggle-group">
                        <input type="radio" id="color_sharp_yes" name="color_sharp" value="yes">
                        <label for="color_sharp_yes" class="toggle-label">Ya</label>
                        
                        <input type="radio" id="color_sharp_no" name="color_sharp" value="no" checked>
                        <label for="color_sharp_no" class="toggle-label">Tidak</label>
                    </div>
                </div>

                <div class="field">
                    <label>Warna pudar?</label>
                    <div class="toggle-group">
                        <input type="radio" id="color_faded_yes" name="color_faded" value="yes">
                        <label for="color_faded_yes" class="toggle-label">Ya</label>
                        
                        <input type="radio" id="color_faded_no" name="color_faded" value="no" checked>
                        <label for="color_faded_no" class="toggle-label">Tidak</label>
                    </div>
                </div>

                <div class="field">
                    <label for="defect_count">Jumlah cacat motif</label>
                    <input type="number" id="defect_count" name="defect_count" min="0" value="0" 
                           placeholder="Masukkan angka">
                </div>

                <div class="field">
                    <label>Kain terasa halus?</label>
                    <div class="toggle-group">
                        <input type="radio" id="fabric_smooth_yes" name="fabric_smooth" value="yes">
                        <label for="fabric_smooth_yes" class="toggle-label">Ya</label>
                        
                        <input type="radio" id="fabric_smooth_no" name="fabric_smooth" value="no" checked>
                        <label for="fabric_smooth_no" class="toggle-label">Tidak</label>
                    </div>
                </div>
            </div>
        </div>

        <button type="submit" class="btn-primary">Analisis</button>
    </form>
</div>

{% if result %}
<div class="result-card">
    <h3>Hasil Klasifikasi</h3>

    {% if result.image_url %}
        <h4>ðŸ“· Foto Referensi</h4>
        <img src="{{ result.image_url }}" class="result-image" alt="Foto batik yang dianalisis">
    {% endif %}

    <p><strong>Teknik Pembuatan:</strong>
        <span class="badge badge-tech">{{ result.technique }}</span>
    </p>

    <p>
        <strong>Kualitas Produk:</strong>
        {% if result.quality == "Premium" %}
            <span class="badge badge-premium">{{ result.quality }}</span>
        {% elif result.quality == "Reject" %}
            <span class="badge badge-reject">{{ result.quality }}</span>
        {% else %}
            <span class="badge badge-standard">{{ result.quality }}</span>
        {% endif %}
    </p>

    <p><strong>Motif:</strong> {{ result.motif_name }}</p>

    <h4>Analisis Teknik</h4>
    <p style="font-size:0.95rem; color:#374151; line-height:1.7;">{{ result.exp_tech }}</p>

    <h4>Analisis Kualitas</h4>
    <p style="font-size:0.95rem; color:#374151; line-height:1.7;">{{ result.exp_qual }}</p>
</div>
{% endif %}
{% endblock %}
